<div class="container">
  <div class="rowpadd breadcrumb" style="padding-top: 0px !important; padding-bottom: 0px !important;">
    <app-miga-pan [items]="migaPan"></app-miga-pan>
  </div>
</div>
<div style="border-top: solid 3px #f4f4f4"></div>
<div class="container">
  <div class="row rowpadd">
    <div class="col-12 col-md-12 col-lg-12">
      <mat-tab-group class="tabVerticalSesiones" [(selectedIndex)]="tabIndex" (selectedTabChange)="tabChanged($event)">
        <ng-container *ngIf="estructuraCapitulo!=undefined">

          <ng-container *ngFor="let item of estructuraCapitulo.registroEstructuraCursoCapitulo;let i=index">

            <mat-tab disabled>
              <ng-template mat-tab-label>
                <div class="contentHeaderM" [ngClass]="{'ActiveChil':item.opened==true}" (click)="changeCapitulo(i)">
                  <div class="titleMatr">{{item.nombreCapitulo}}</div>
                  <i *ngIf="item.opened==true" class="material-icons">keyboard_arrow_up</i>
                  <i *ngIf="item.opened==false" class="material-icons">keyboard_arrow_down</i>
                </div>
              </ng-template>
              <div style="padding: 10px 30px">
                <ng-template matTabContent>
                </ng-template>
              </div>
            </mat-tab>

            <!-- encuesta incial -->
            <ng-container
              *ngIf="item.registroEstructuraCursoEncuesta!=undefined && item.registroEstructuraCursoEncuesta!=null">
              <ng-container *ngFor="let Encuesta of item.registroEstructuraCursoEncuesta;let e=index">
                <ng-container *ngIf="Encuesta.tipoExamen=='Encuesta' && Encuesta.nombreEncuesta=='Encuesta Inicial'">

                  <mat-tab>
                    <ng-template mat-tab-label>
                      <div class="contentHeaderM estructuraSubCapitulos" (click)="changeTab(3,0,i,e,0)" [ngClass]="{'hidetab':item.opened==false}">
                        <div class="titleMatr">{{Encuesta.nombreEncuesta}}</div>
                      </div>
                    </ng-template>
                    <div style="padding: 10px 30px">
                        <app-sesion-encuesta [json]="json" [idCapitulo]="item.numeroCapitulo" [NombreCapitulo]="item.nombreCapitulo" [idEncuesta]="Encuesta.idEncuesta"
                        [charge]="Encuesta.charge"></app-sesion-encuesta>
                    </div>
                  </mat-tab>
                </ng-container>
              </ng-container>
            </ng-container>
            <!-- sesiones y subsesiones -->


            <!--sin subsesion-->
            <ng-container *ngIf="estructuraCapitulo.contineSubSesion==false">
              <ng-container *ngFor="let sesion of item.registroEstructuraCursoSesion;let s=index">
                <mat-tab>
                  <ng-template mat-tab-label>
                    <div (click)="changeTab(1,sesion.numeroSesion,i,s,-1)" class="contentHeaderM estructuraSubCapitulos"
                      [ngClass]="{'hidetab':item.opened==false}">
                      <div class="titleMatr">{{sesion.nombreSesion}}</div>
                    </div>
                  </ng-template>
                  <div style="padding: 10px 30px">

                      <app-sesion-video [json]="json" [idCapitulo]="item.numeroCapitulo" [NombreCapitulo]="item.nombreCapitulo" [charge]="sesion.charge"
                        [idSesion]="sesion.numeroSesion" [nombreSesion]="sesion.nombreSesion"></app-sesion-video>
                  </div>
                </mat-tab>
              </ng-container>
            </ng-container>
            <!--con subsesion-->
            <ng-container *ngIf="estructuraCapitulo.contineSubSesion==true">
              <ng-container *ngFor="let sesion of item.registroEstructuraCursoSesion;let s=index">
                <mat-tab disabled>
                  <ng-template mat-tab-label>
                    <div class="contentHeaderM estructuraSubCapitulos" (click)="changeSesion(i,s)"
                      [ngClass]="{'ActiveChil':sesion.opened==true,'hidetab':item.opened==false}">
                      <div class="titleMatr">{{sesion.nombreSesion}}</div>
                      <i *ngIf="sesion.opened==true" class="material-icons">keyboard_arrow_up</i>
                      <i *ngIf="sesion.opened==false" class="material-icons">keyboard_arrow_down</i>
                    </div>
                  </ng-template>
                </mat-tab>
                <ng-container *ngFor="let subsesion of sesion.registroEstructuraCursoSubSesion;let ss=index">
                  <mat-tab>
                    <ng-template mat-tab-label>
                      <div (click)="changeTab(1,subsesion.numeroSubSesion,i,s,ss)" class="contentHeaderM estructuraSubSesiones"
                        [ngClass]="{'hidetab':item.opened==false || sesion.opened==false}">
                        <div class="titleMatr">{{subsesion.nombreSubSesion}}</div>
                      </div>
                    </ng-template>
                    <div style="padding: 10px 30px">

                      <app-sesion-video [json]="json" [idCapitulo]="item.numeroCapitulo" [charge]="subsesion.charge"
                        [idSesion]="subsesion.numeroSubSesion" [NombreCapitulo]="item.nombreCapitulo" [nombreSesion]="subsesion.nombreSubSesion"></app-sesion-video>
                    </div>
                  </mat-tab>
                </ng-container>
              </ng-container>
            </ng-container>
            <!-- tareas -->
            <ng-container
              *ngIf="item.registroEstructuraCursoTarea!=undefined && item.registroEstructuraCursoTarea!=null">
              <ng-container *ngFor="let tarea of item.registroEstructuraCursoTarea;let t=index">

                <mat-tab>
                  <ng-template mat-tab-label>
                    <div class="contentHeaderM estructuraSubCapitulos" (click)="changeTab(2,0,i,t,0)" [ngClass]="{'hidetab':item.opened==false}">
                      <div class="titleMatr">{{tarea.tarea}}</div>
                    </div>
                  </ng-template>
                  <div style="padding: 10px 30px">
                      <app-sesion-tarea [json]="json" [idCapitulo]="item.numeroCapitulo" [NombreCapitulo]="item.nombreCapitulo" [idtarea]="tarea.idTarea"
                      [charge]="tarea.charge"></app-sesion-tarea>
                  </div>
                </mat-tab>
              </ng-container>
            </ng-container>

            <!-- encuestas finales -->
            <ng-container
              *ngIf="item.registroEstructuraCursoEncuesta!=undefined && item.registroEstructuraCursoEncuesta!=null">
              <ng-container *ngFor="let Encuesta of item.registroEstructuraCursoEncuesta;let e=index">
                <ng-container *ngIf="Encuesta.tipoExamen=='Encuesta' && Encuesta.nombreEncuesta=='Encuesta Intermedia'">

                  <mat-tab>
                    <ng-template mat-tab-label>
                      <div class="contentHeaderM estructuraSubCapitulos" (click)="changeTab(3,0,i,e,0)" [ngClass]="{'hidetab':item.opened==false}">
                        <div class="titleMatr">{{Encuesta.nombreEncuesta}}</div>
                      </div>
                    </ng-template>
                    <div style="padding: 10px 30px">

                        <app-sesion-encuesta [json]="json" [idCapitulo]="item.numeroCapitulo" [NombreCapitulo]="item.nombreCapitulo" [idEncuesta]="Encuesta.idEncuesta"
                        [charge]="Encuesta.charge"></app-sesion-encuesta>
                    </div>
                  </mat-tab>
                </ng-container>
                <ng-container *ngIf="Encuesta.tipoExamen=='Encuesta' && Encuesta.nombreEncuesta=='Encuesta Final'">

                  <mat-tab>
                    <ng-template mat-tab-label>
                      <div class="contentHeaderM estructuraSubCapitulos" (click)="changeTab(3,0,i,e,0)" [ngClass]="{'hidetab':item.opened==false}">
                        <div class="titleMatr">{{Encuesta.nombreEncuesta}}</div>
                      </div>
                    </ng-template>
                    <div style="padding: 10px 30px">

                        <app-sesion-encuesta [json]="json" [idCapitulo]="item.numeroCapitulo" [NombreCapitulo]="item.nombreCapitulo" [idEncuesta]="Encuesta.idEncuesta"
                        [charge]="Encuesta.charge"></app-sesion-encuesta>
                    </div>
                  </mat-tab>
                </ng-container>

              </ng-container>
            </ng-container>

          </ng-container>
        </ng-container>
      </mat-tab-group>
    </div>
  </div>
</div>
