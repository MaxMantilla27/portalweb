<!-- holax1 -->
<div class="contentChat">
  <div class="headerChatAula">
    <div class="imgAsesor">
      <img [src]="img" (error)="ErrorImgAsesor()" alt="" />
      <div class="nombreAsesor">
        <div *ngIf="nombreasesorglobal != ''" style="margin-left: 15px">
          <div>{{ nombreAsesorSplit[0] }} {{ nombreAsesorSplit[1] }}</div>
          <div style="font-size: 14px; font-weight: 500">BSG Institute</div>
        </div>
        <div *ngIf="nombreasesorglobal == ''" style="text-align: center">
          Chatea en línea con tu coordinador académico
        </div>

        <!-- <mat-icon style="cursor:pointer" (click)="GenerarLogVisitanteAulaVirtualAcademico()">autorenew</mat-icon> -->
        <div
          class="stateAsesor"
          [ngClass]="{ OnConected: stateAsesor == true }"
        ></div>
      </div>
      <div style="width: 10%">
        <span
          style="width: 10%; cursor: pointer; font-weight: bold"
          (click)="Open = false; IsOpen.emit(false); toggleChat(false)"
          >-</span
        >
      </div>
    </div>
    <!-- <div class="textoAsesor" *ngIf="estadoLogueo!='false'">Soy {{nombreAsesorSplit[0]}} , {{mensajeStateAsesor}}</div> -->
  </div>
  <ng-container>
    <!--<div class="FlechaAtrasMatricula no-select" (click)="showConfirmationDialog = true">
      <i class="material-icons">arrow_back_ios</i>
      <span>Atras</span>
    </div>-->
    <div *ngIf="showConfirmationDialog" class="confirmation-dialog-atras">
      <!-- <p>¿Deseas salir de esta sesión de chat? La conversación se dará por finalizada.</p> -->
      <p>
        Tu sesión de chat se cerrará por inactividad. Gracias por conversar con
        nosotros. ¡Te esperamos nuevamente cuando lo necesites!
      </p>
      <button
        style="background: #ff8610; color: white"
        (click)="confirmAction()"
      >
        Aceptar
      </button>
      <!-- <button style="background: transparent;color:#033DAB;border: 1px solid #033DAB;"(click)="cancelAction()">Cancelar</button> -->
    </div>
    <div
      *ngIf="!showConfirmationDialog"
      #contenidoMsj
      class="contentChatMsj"
      (click)="marcarChatAgentecomoleido()"
    >
      <div class="mensajeDefecto">Chat iniciado</div>
      <!-- <div class="mensajeDefecto">{{nombreAsesorSplit[0]}} {{nombreAsesorSplit[1]}} se unió al Chat</div> -->

      <ng-container *ngFor="let item of mensajesAnteriore; let i = index">
        <div
          [ngClass]="{
            visitanteMsj: item.IdRemitente.toLowerCase() == 'visitante',
            asesorMsj: item.IdRemitente.toLowerCase() == 'asesor'
          }"
        >
          <div class="cntnmsj">
            <!-- <div class="remitente">{{item.NombreRemitente.split(' ')[0]}}</div> -->
            <div
              *ngIf="!item.esImagen"
              class="msj"
              [innerHtml]="item.Mensaje | safeHtml"
            ></div>
            <div class="msj">
              <img
                *ngIf="item.esImagen"
                [src]="item.url"
                alt="Imagen en el chat"
                style="
                  max-width: 180px;
                  max-height: 80px;
                  width: auto;
                  height: auto;
                  cursor: pointer;
                "
                (click)="ampliarImagen(item.url)"
              />
            </div>

            <div *ngFor="let pdfUrl of pdfsEnChat">
              <iframe [src]="pdfUrl" width="100%" height="150px"></iframe>
            </div>
            <ng-container *ngIf="item.IdRemitente.toLowerCase() == 'visitante'">
              <ng-container *ngIf="item.estadoEnviado == false">
                <div class="statemsjEnviado">
                  <i class="material-icons">access_time</i>
                </div>
              </ng-container>
              <ng-container *ngIf="item.estadoEnviado != false">
                <!-- <ng-container  *ngIf="(mensajesAnteriore.length-i)>=NroMensajesSinLeer">
                    <div class="statemsjleido">
                      <i class="material-icons" style="right: 4px;
                      z-index: 3;">check</i>
                      <i class="material-icons" style="right: 1px;
                      z-index: 4;">check</i>
                    </div>
                  </ng-container>
                  <ng-container *ngIf="(mensajesAnteriore.length-i)<NroMensajesSinLeer">
                    <div class="statemsjnoleido">
                      <i class="material-icons" style="right: 4px;
                      z-index: 3;">check</i>
                      <i class="material-icons" style="right: 1px;
                      z-index: 4;">check</i>
                    </div>
                  </ng-container> -->
              </ng-container>
            </ng-container>
          </div>
          <div
            *ngIf="item.IdRemitente.toLowerCase() != 'visitante'"
            class="fecha-asesor"
          >
            {{ item.FechaEnvio }}
          </div>
          <div
            *ngIf="item.IdRemitente.toLowerCase() == 'visitante'"
            class="fecha-visitante"
          >
            {{ item.FechaEnvio }}
          </div>
        </div>
      </ng-container>
    </div>
    <div
      *ngIf="!showConfirmationDialog"
      class="footerChatAula"
      (click)="marcarChatAgentecomoleido()"
    >
      <textarea
        class="chat-box-ia-textarea"
        [(ngModel)]="chatBox"
        (input)="redimendisionarTextareaChatbot($event)"
        (keydown.enter)="
          $event.preventDefault();
          $event.stopPropagation();
          enviarMensajeVisitanteAcademico();
          resetTextareaHeight();
        "
        (focus)="inputActive = true"
        (focusout)="inputActive = false"
        [attr.autofocus]="inputActive ? true : null"
        placeholder="Escribe tu mensaje aquí"
        rows="1"
      ></textarea>
      <i class="material-icons" (click)="enviarMensajeVisitanteAcademico()"
        >send</i
      >
      <i class="material-icons addfile" (click)="fileInput.click()"
        >attach_file</i
      >
      <!-- <input  #fileInput type="file" style="display:none;" accept="image/png, image/gif, image/jpeg" (change)="AgregarArchivoChatSoporte($event)"> -->
      <input
        #fileInput
        type="file"
        style="display: none"
        type="file"
        style="display: none"
        accept="image/png, image/jpeg, image/jpg, image/jfif, application/pdf, application/msword, application/vnd.openxmlformats-officedocument.wordprocessingml.document, application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
        (change)="AgregarArchivoChatSoporte($event)"
      />
    </div>
  </ng-container>
</div>
